
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Regla 1: Acceso de lectura pública para la configuración de la landing page.
    // Cualquiera puede leer esta configuración, pero nadie puede escribir sin autenticación.
    match /landing_configs/{configId} {
      allow read: if true;
      allow write: if request.auth != null; // Solo usuarios autenticados (superadmins) pueden escribir.
    }

    // Regla 2: Acceso de lectura pública para los planes de suscripción que se muestran en la landing.
    match /landingPlans/{planId} {
      allow read: if true;
      allow write: if request.auth != null; // Solo usuarios autenticados (superadmins) pueden escribir.
    }
    
    // Regla 3: Acceso restringido para la información de compañías y sus sub-colecciones (platos, empleados, etc.).
    // Solo usuarios autenticados pueden leer o escribir. Se podrían añadir más reglas por rol aquí.
    match /companies/{companyId}/{document=**} {
      allow read, write: if request.auth != null;
    }
    
    // Regla 4: Los usuarios solo pueden leer o modificar su propio documento de usuario.
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Regla 5: Las demás colecciones (orders, reservations, etc.) requieren autenticación.
    // Esta es una regla general que se puede hacer más específica si es necesario.
    match /{path=**}/documents/{documentId} {
        allow read, write: if request.auth != null;
    }

  }
}
