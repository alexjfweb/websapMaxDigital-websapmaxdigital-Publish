rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Regla #1: Permite el acceso de lectura pública a las configuraciones de la landing page.
    // Esto es ESENCIAL para que la página de inicio pueda cargar su contenido dinámico sin errores.
    match /landing_configs/{docId} {
      allow read: if true;
      allow write: if request.auth != null; // Solo usuarios autenticados (superadmins) pueden escribir.
    }

    // Regla #2: Permite el acceso de lectura pública a los planes de la landing page.
    // Esta es la corrección clave. Apunta a "landingPlans", que es el nombre correcto de la colección.
    match /landingPlans/{docId} {
      allow read: if true;
      allow write: if request.auth != null; // Solo usuarios autenticados (superadmins) pueden escribir.
    }
    
    // Regla #3: Protege el resto de las colecciones.
    // Solo los usuarios que han iniciado sesión pueden leer o escribir en colecciones como 'users',
    // 'companies', 'orders', etc. Esto asegura la privacidad de los datos.
    match /{path=**}/documents/{document} {
      allow read, write: if request.auth != null;
    }
  }
}
